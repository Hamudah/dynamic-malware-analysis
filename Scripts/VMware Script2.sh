#!/bin/bash

#Create Windows 10 32-bit VM
vmware-cmd --create /path/to/Windows10.vmx

#Create Ubuntu VM with FTP server
vmware-cmd --create /path/to/Ubuntu.vmx

# Take a snapshot of the Windows10 VM
vmrun -T ws -gu username -gp password snapshot /path/to/Windows10.vmx "Initial Snapshot"

# Start both VMs
vmware-cmd /path/to/Windows10.vmx start
vmware-cmd /path/to/Ubuntu.vmx start

# Configure network settings
# This will vary depending on your specific network settings
# You may want to configure a NAT or host-only network to limit the Windows VMs access to the host system and the internet

# Set the initial path for the malware files
path=1

# Loop through all malwares
while true; do
  # Run malware in Windows VM
  vmrun -T ws -gu username -gp password runProgramInGuest /path/to/Windows10.vmx -interactive -activeWindow /path/to/malware-${path}.exe

  # Wait for one minute
  sleep 60

  # Gather data about malware using Intel Pin Tool
  pin -t /path/to/pin.exe -- /path/to/malware-${path}.exe

  # Send data to Ubuntu VM via FTP
  ftp -p IP_ADDRESS <<EOF
  user username password
  put /path/to/malware-data-${path}.txt
  exit
EOF

  # Revert the Windows10 VM back to the snapshot
vmrun -T ws -gu username -gp password revertToSnapshot /path/to/Windows10.vmx "Initial Snapshot"

# Increase the malware file path number
path=$((path+1))
done

This script starts by creating the Windows10 and Ubuntu VMs, taking an initial snapshot, starting them and configuring network settings. Then, it sets an initial value for the path of the malware files and enters a loop. On each iteration, the script runs the malware, waits for 1 minute, gathers data, sends it via FTP, reverts the Windows10 VM back to the initial snapshot and increases the malware file path.
This way, the script continues to run malwares sequentially, using the same process every time and leaving the Windows10 VM in a consistent state after each run.
Please note that you will have to adjust the script to your specific setup, such as paths to files and executables, credentials, and network settings.
