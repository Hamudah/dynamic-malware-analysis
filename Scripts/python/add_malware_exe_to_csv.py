import os
import csv

exe_files_directory = r'C:\Users\hamud\Desktop\Malware'
output_csv_file = r'C:\Users\hamud\Desktop\dynamic-malware-analysis-main\config_files\malware_list.csv'

def main():
    exe_files = []

    for exe_file in os.listdir(exe_files_directory):
        if exe_file.endswith('.exe'):
            software_name = os.path.splitext(exe_file)[0]
            command = os.path.join(exe_files_directory, exe_file)
            exe_files.append([software_name, command])

    with open(output_csv_file, 'w', newline='') as csvfile:
        csv_writer = csv.writer(csvfile)
        csv_writer.writerow(['name', 'exe'])
        for exe_file in exe_files:
            csv_writer.writerow(exe_file)

if __name__ == '__main__':
    main()