import subprocess
import os

def identify_and_rename_exe_files(folder_path, trid_path):
    exe_files = []

    for file in os.listdir(folder_path):
        file_path = os.path.join(folder_path, file)
        if os.path.isfile(file_path):
            result = subprocess.run([trid_path, '-ns', file_path], capture_output=True, text=True)
            if 'Win32 EXE' in result.stdout:
                exe_files.append(file)
                new_file_path = os.path.splitext(file_path)[0] + ".exe"
                os.rename(file_path, new_file_path)

    return exe_files

if __name__ == "__main__":
    folder_path = "path/to/your/folder"
    trid_path = "path/to/trid.exe"

    exe_files = identify_and_rename_exe_files(folder_path, trid_path)
    print("Identified and renamed .exe files:", exe_files)
