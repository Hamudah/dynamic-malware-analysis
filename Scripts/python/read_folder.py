import os
import csv

exe_files_directory = r'D:\BA\SysInternals'
output_csv_file = r'D:\BA\dynamic-malware-analysis\config_files\goodware_list4.csv'

def main():
    exe_files = []

    for exe_file in os.listdir(exe_files_directory):
        if exe_file.endswith('.exe') and "64" in exe_file:
            software_name = os.path.splitext(exe_file)[0]
            command = os.path.join(exe_files_directory, exe_file)
            args = "-accepteula"
            exe_files.append([software_name, command, args])

    with open(output_csv_file, 'w', newline='') as csvfile:
        csv_writer = csv.writer(csvfile)
        csv_writer.writerow(['name', 'exe', 'args'])
        for exe_file in exe_files:
            csv_writer.writerow(exe_file)

if __name__ == '__main__':
    main()
