import csv
import subprocess
import time
import os

# Intel Pin executable path
pin_path = "path/to/pin.exe"
# Path to your Pintool's DLL
pintool_path = "path/to/your/pintool.dll"

# FTP information
ftp_server = "192.178.162.1"
ftp_username = "ftpuser"
ftp_password = "ftpuser"

# Read the CSV file
with open("goodware_list.csv", "r") as csvfile:
    reader = csv.reader(csvfile)

    # Loop through each goodware application
    for row in reader:
        exe_name = row[0]
        args = row[1] if len(row) > 1 else ""

        # Run the goodware application with Intel Pin and specified arguments
        cmd = f"{pin_path} -t {pintool_path} -- {exe_name} {args}"
        print(f"Running: {cmd}")
        process = subprocess.Popen(cmd, shell=True)

        # Wait for 1 minute
        time.sleep(60)

        # Terminate the goodware application
        process.terminate()

        # Send the collected data to the FTP server
        # You may need to modify this command depending on the FTP client you're using
        ftp_cmd = f"ftp -s:\"{ftp_username}\n{ftp_password}\nmput path/to/your/output/files/*\nbye\n\" {ftp_server}"
        os.system(ftp_cmd)

        # Remove or move the collected data files to avoid overwriting
        # Add your cleanup code here
